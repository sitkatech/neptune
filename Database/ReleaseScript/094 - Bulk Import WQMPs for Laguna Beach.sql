
/******CREATE DATA******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[WQMPs_LagunaBeach](
	[Name] [nvarchar](50) NOT NULL,
	[Jurisdiction_Record_ID] [nvarchar](50) NOT NULL,
	[Jurisdiction] [nvarchar](50) NOT NULL,
	[Latitude] [float] NOT NULL,
	[Longitude] [float] NOT NULL,
	[Parcel_Number] [nvarchar](50) NOT NULL,
	[Site_Address] [nvarchar](50) NOT NULL
) ON [PRIMARY]
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'The Capri Laguna', N'PIN 7100', N'City of Laguna Beach', 33.53127, -117.77479, N'644-217-08', N'1441 S. Coast Hwy (1417 S Coast Hwy)')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Rosenstein Residence', N'PIN 629', N'City of Laguna Beach', 33.54588, -117.79988, N'053-161-11', N'1125 Marine Drive')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'McLeod Residence', N'PIN 5901', N'City of Laguna Beach', 33.53222, -117.77673, N'644-074-19', N'1275 Ocean Front')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Hayden Residence', N'PIN 1887', N'City of Laguna Beach', 33.4899, -117.73653, N'056-180-12', N'14 S. La Senda')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Emerald Financial, LLC Residence', N'PIN 7089', N'City of Laguna Beach', 33.53147, -117.7755, N'644-216-14', N'150 Mountain Road')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Garner Single Family Residence', N'PIN 7121', N'City of Laguna Beach', 33.53146, -117.77243, N'644-221-14', N'1530 Glenneyre')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Crevier Residence', N'PIN 11661', N'City of Laguna Beach', 33.52534, -117.76781, N'656-114-35', N'165 Moss Street')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Mihaylo Residence', N'PIN 10555', N'City of Laguna Beach', 33.51826, -117.76159, N'656-171-26', N'18 Lagunita Drive')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Towfiq residence', N'PIN 9904', N'City of Laguna Beach', 33.52429, -117.76657, N'656-114-10', N'2425 South Coast Hy')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'2565 Riviera Drive Residence', N'PIN 11642', N'City of Laguna Beach', 33.55476, -117.81671, N'120-561-38', N'2565 Riviera Drive')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'2585 Riviera Drive', N'PIN 11449', N'City of Laguna Beach', 33.5549, -117.81743, N'120-561-35', N'2585 Riviera Drive')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Yousefi Residence', N'PIN 2343', N'City of Laguna Beach', 33.55638, -117.81947, N'120-561-28', N'2695 Riviera Drive')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Weeda Family Trust II', N'PIN 11517', N'City of Laguna Beach', 33.5543, -117.77328, N'641-181-61', N'272 Canyon Acres Drive')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'2828 Wards Terrace', N'PIN 10292', N'City of Laguna Beach', 33.5204, -117.763, N'656-151-71', N'2828 Wards Terrace')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'The Ranch', N'PIN 2315', N'City of Laguna Beach', 33.51304, -117.74843, N'056-240-47', N'31106 Coast Highway')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Corwin Residence', N'PIN 859', N'City of Laguna Beach', 33.50699, -117.74917, N'056-032-04', N'31351 Coast Highway')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'31791 South Coast Highway', N'PIN 10930', N'City of Laguna Beach', 33.50077, -117.74376, N'658-101-45', N'31791 South Coast Highway')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'31945 Coast Highway', N'PIN 11005', N'City of Laguna Beach', 33.49849, -117.74102, N'658-113-48', N'31945 Coast Highway')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Jhiangiani Residence', N'PIN 5397', N'City of Laguna Beach', 33.55523, -117.75991, N'641-461-09', N'3325 Alta Laguna')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Glenn Residence', N'PIN 4740', N'City of Laguna Beach', 33.54448, -117.77938, N'641-272-13', N'346 Y Place')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'485 Panorama Drive', N'PIN 39', N'City of Laguna Beach', 33.55353, -117.80104, N'053-092-24', N'485 Panorama Drive')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'500 Mystic Way', N'PIN 11623', N'City of Laguna Beach', 33.54478, -117.77884, N'641-281-10', N'500 Mystic Way')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Festival of the Arts Interior', N'PIN 2672', N'City of Laguna Beach', 33.54869, -117.78297, N'496-101-02', N'650 Laguna Canyon Road')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Festival of the Arts Frontage', N'PIN 2673', N'City of Laguna Beach', 33.54836, -117.78189, N'496-101-02', N'650 Laguna Canyon Road')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Desai Residence ', N'PIN 1859', N'City of Laguna Beach', 33.49327, -117.73862, N'056-172-09', N'74 North La Senda')
GO
INSERT [dbo].[WQMPs_LagunaBeach] ([Name], [Jurisdiction_Record_ID], [Jurisdiction], [Latitude], [Longitude], [Parcel_Number], [Site_Address]) VALUES (N'Miscione Residence', N'PIN 661', N'City of Laguna Beach', 33.546, -117.79722, N'053-162-18', N'887 Cliff Drive')
GO




/*******IMPORT*********/

DECLARE @TenantID int
SET @TenantID = 2

/********************WQMPs***************/
--SELECT * FROM dbo.WaterQualityManagementPlan

INSERT INTO dbo.WaterQualityManagementPlan (TenantID, StormwaterJurisdictionID, WaterQualityManagementPlanName, RecordNumber) 
SELECT DISTINCT
@TenantID,
StormwaterJurisdictionID,
Name,
Jurisdiction_Record_ID
FROM dbo.WQMPs_LagunaBeach a
JOIN dbo.Organization o 
on a.Jurisdiction = o.OrganizationName and o.TenantID = @TenantID
JOIN dbo.StormwaterJurisdiction sj
on o.OrganizationID = sj.OrganizationID

--SELECT * FROM dbo.WaterQualityManagementPlan

/***************WaterQualityManagementPlanParcel**********************/
--Join by parcel number
 
SELECT * FROM WaterQualityManagementPlanParcel

INSERT INTO dbo.WaterQualityManagementPlanParcel (TenantID, WaterQUalityManagementPlanID, ParcelID)
SELECT DISTINCT @TenantID, WaterQualityManagementPlanID, ParcelID
FROM
dbo.WQMPs_LagunaBeach a
JOIN dbo.Parcel p
on a.Parcel_Number = p.ParcelNumber
JOIN dbo.Organization o 
on a.Jurisdiction = o.OrganizationName and o.TenantID = @TenantID
JOIN dbo.StormwaterJurisdiction sj
on o.OrganizationID = sj.OrganizationID
JOIN dbo.WaterQualityManagementPlan mp
on a.Name = mp.WaterQualityManagementPlanName and sj.StormwaterJurisdictionID = mp.StormwaterJurisdictionID


SELECT * FROM WaterQualityManagementPlanParcel

drop table WQMPs_LagunaBeach
