<div class="documents">
    <h3>Documents</h3>

    @if(waterQualityManagementPlan$ | async; as waterQualityManagementPlan) {
    <div class="page-body">
        @if (waterQualityManagementPlanDocuments$ | async; as waterQualityManagementPlanDocuments) { @for (waterQualityManagementPlanDocumentType of
        getWaterQualityManagementPlanDocumentTypes(); track $index) { @if (getDocumentsByType(waterQualityManagementPlanDocuments,
        waterQualityManagementPlanDocumentType.Value).length > 0) {
        <h4 class="document__sub-header">{{ waterQualityManagementPlanDocumentType.DisplayName }}</h4>
        @for (waterQualityManagementPlanDocument of getDocumentsByType(waterQualityManagementPlanDocuments, waterQualityManagementPlanDocumentType.Value); track $index) {
        <water-quality-management-plan-document
            [keyDocument]="waterQualityManagementPlanDocument"
            [waterQualityManagementPlan]="waterQualityManagementPlan"
            [isLoading]="isLoading"
            (openDocumentChatBot)="onClickOpenWaterQualityManagementPlanSummary($event.waterQualityManagementPlan, $event.keyDocument)"
            (download)="downloadFile($event)"
            (extractData)="onClickExtractData($event.waterQualityManagementPlan, $event.keyDocument)">
        </water-quality-management-plan-document>
        } } } }
    </div>
    }

    <!-- Extracted Data Panel -->
    @if (isExtractingData) {
    <div class="extracted-data-panel loading">
        <span>Extracting data...</span>
    </div>
    } @else if (extractedDataResult) {
    <div class="extracted-data-panel">
        <h4>Extracted Data</h4>
        @if (extractedDataResult.error) {
        <div class="error">{{ extractedDataResult.error }}</div>
        <pre>{{ extractedDataResult.details }}</pre>
        } @else {
        <pre>{{ extractedDataResult }}</pre>
        }
    </div>
    }
</div>
