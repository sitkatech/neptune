<div class="treatment-bmp-detail">
    <!-- Alerts and Info -->
    @if (!isAnonymousOrUnassigned) { @if (treatmentBMP$ | async; as treatmentBMP) {
    <page-header [pageTitle]="treatmentBMP.BMPName" [templateRight]="templateRight" [templateAbove]="templateAbove"></page-header>
    <ng-template #templateRight>
        <!-- Example: Edit/View/Verify actions -->
        <a [routerLink]="getEditLink(treatmentBMP)" class="btn btn-primary mr-2">Edit</a>
        <!-- TODO: Add more actions as needed -->
    </ng-template>
    <ng-template #templateAbove>
        <div class="back">
            <a [routerLink]="['../']" class="back__link">Back to BMP Grid</a>
        </div>
    </ng-template>
    <app-alert-display></app-alert-display>
    @if (delineationErrors?.length) {
    <span>This BMP delineation may have errors:</span>
    <ul>
        @for (err of delineationErrors; track $index) {
        <li>{{ err }}</li>
        }
    </ul>
    } @if (parameterizationErrors?.length) {
    <span>This BMP is not fully parameterized:</span>
    <ul>
        @for (err of parameterizationErrors; track $index) {
        <li>{{ err }}</li>
        }
    </ul>
    } @if (openRevisionRequest) {
    <div class="alert alert-info">There is an open <a [routerLink]="openRevisionRequestDetailUrl">Regional Subbasin Revision Request</a> relating to this BMP.</div>
    } @if (upstreamestBMP && !isUpstreamestBMPAnalyzedInModelingModule) {
    <div class="alert alert-info">This BMP is downstream of a non-modeled BMP, and therefore will not have model results or land use statistics.</div>
    }

    <div class="grid-12 mt-2 mb-3">
        <div class="card">
            <div class="card-header">
                <span class="card-title">BMP Basics</span>
            </div>
            <div class="card-body">
                <dl class="grid-12">
                    <dt class="g-col-4">Name</dt>
                    <dd class="g-col-8">{{ treatmentBMP.BMPName }}</dd>
                    <dt class="g-col-4">Type</dt>
                    <dd class="g-col-8">{{ treatmentBMP.TreatmentBMPType?.TreatmentBMPTypeDisplayName }}</dd>
                    <dt class="g-col-4">Status</dt>
                    <dd class="g-col-8">{{ treatmentBMP.StatusDisplayName }}</dd>
                    <dt class="g-col-4">Date Created</dt>
                    <dd class="g-col-8">{{ treatmentBMP.DateCreated | date : "MM/dd/yyyy" }}</dd>
                    <dt class="g-col-4">Date Updated</dt>
                    <dd class="g-col-8">{{ treatmentBMP.DateUpdated | date : "MM/dd/yyyy" }}</dd>
                    <dt class="g-col-4">Jurisdiction</dt>
                    <dd class="g-col-8">{{ treatmentBMP.StormwaterJurisdiction?.Organization?.OrganizationName }}</dd>
                    <dt class="g-col-4">Primary Contact</dt>
                    <dd class="g-col-8">{{ treatmentBMP.PrimaryContactPerson?.FullName }}</dd>
                    <dt class="g-col-4">Additional Contact Information</dt>
                    <dd class="g-col-8">
                        {{ treatmentBMP.AdditionalContactInformation }}
                        @if (!treatmentBMP.AdditionalContactInformation) {
                        <em class="text-muted">None Provided</em>
                        }
                    </dd>
                    <!-- TODO: Add more fields as needed -->
                </dl>
            </div>
        </div>
    </div>

    <!-- Map and Images -->
    <div class="grid-12 mt-3 mb-3">
        <div class="card">
            <div class="card-header"><span class="card-title">Location & Map</span></div>
            <div class="card-body">
                <!-- TODO: Add map component or static map here -->
            </div>
        </div>
        <div class="card mt-2">
            <div class="card-header"><span class="card-title">Images</span></div>
            <div class="card-body">
                <!-- TODO: Add image carousel/gallery here -->
            </div>
        </div>
    </div>

    <!-- Model Results -->
    @if (isAnalyzedInModelingModule) {
    <div class="mt-3 mb-3">
        <div class="card">
            <div class="card-header"><span class="card-title">Model Results</span></div>
            <div class="card-body">
                <!-- TODO: Add modeled performance fields -->
            </div>
        </div>
    </div>
    }

    <!-- Attachments -->
    @if (attachments$ | async; as attachments) {
    <div class="row mt-3 mb-3">
        @if (attachments.length > 0) {
        <div class="col-12">
            <div class="card">
                <div class="card-header"><span class="card-title">Attachments</span></div>
                <div class="card-body">
                    <!-- TODO: Add attachments display component -->
                </div>
            </div>
        </div>
        }
    </div>
    } } }
</div>
