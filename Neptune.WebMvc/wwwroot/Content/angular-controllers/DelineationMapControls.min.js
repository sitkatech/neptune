var stopClickPropagation=function(n){L.DomEvent.on(n,"mouseover",function(){window.freeze=!0});L.DomEvent.on(n,"mouseout",function(){window.freeze=!1})};L.Control.DelineationMapSelectedAsset=L.Control.extend({templateID:"selectedAssetControlTemplate",onAdd:function(){var n=L.DomUtil.create("div");return this.parentElement=n,n.id="selectedAssetControlContainer",stopClickPropagation(this.parentElement),n},getTrackedElement:function(n){return this.parentElement.querySelector("#"+n)},treatmentBMP:function(n,t){this.treatmentBMPFeature=n;$("#verifyDelineationButton").bootstrapToggle({onstyle:"btn btn-neptune btn-sm",offstyle:"sm btn-default",style:"neptuneToggle"});var i=this;jQuery("#verifyDelineationButton").off("change");t==="Verified"?$("#verifyDelineationButton").bootstrapToggle("on"):$("#verifyDelineationButton").bootstrapToggle("off");jQuery("#verifyDelineationButton").change(function(){window.freeze&&i.changeDelineationStatus(jQuery(this).prop("checked"))})},launchDrawCatchmentMode:function(n){if(this.drawModeOptions=n,this.getTrackedElement("vertexControlContainer").style.display="none",this.getTrackedElement("delineationVertexThinningButton").innerHTML="Thin",this.getTrackedElement("delineationVertexThinningButton").style.display=n.delineationStrategy===STRATEGY_MANUAL&&n.newDelineation?"none":"initial",this.thinButtonHandler=function(){this.enableThinning()},!this.slider){this.slider=new Slider("#vertexControl",{formatter:function(n){return"Current value: "+n},tooltip:"hide",ticks:[TOLERANCE_DISTRIBUTED,TOLERANCE_CENTRALIZED],ticks_positions:[0,100],ticks_labels:["More","Less"],min:TOLERANCE_DISTRIBUTED,max:TOLERANCE_CENTRALIZED,step:TOLERANCE_STEP_INCREMENT,value:TOLERANCE_DISTRIBUTED});this.slider.on("slideStop",function(n){this.thin(n)}.bind(this))}this.slider.setValue(TOLERANCE_DISTRIBUTED)},thin:function(n){window.delineationMap.thinDelineationVertices(this.drawModeOptions,n)},acceptThinning:function(){this.getTrackedElement("vertexControlContainer").style.display="none";this.getTrackedElement("delineationVertexThinningButton").innerHTML="Reset";this.thinButtonHandler=function(){this.unthin()}},unthin:function(){window.delineationMap.unthinDelineationVertices();this.getTrackedElement("delineationVertexThinningButton").innerHTML="Thin";this.thinButtonHandler=function(){this.enableThinning()}},enableThinning:function(){this.getTrackedElement("vertexControlContainer").style.display="initial";this.getTrackedElement("delineationVertexThinningButton").innerHTML="Accept";this.slider.resize();this.thinButtonHandler=function(){this.acceptThinning()}},changeDelineationStatus:function(n){window.delineationMap.changeDelineationStatus(n)},flipVerifyButton:function(n){if(n)jQuery(this.getTrackedElement("verifyDelineationButton")).data("bs.toggle").on(!0);else jQuery(this.getTrackedElement("verifyDelineationButton")).data("bs.toggle").off(!0)},showVerifyButton:function(){this.getTrackedElement("delineationStatus").style.display="initial"},showDeleteButton:function(){this.getTrackedElement("deleteDelineationButton").style.display="initial"}});L.control.delineationSelectedAsset=function(n){return new L.Control.DelineationMapSelectedAsset(n)};L.Control.BeginDelineation=L.Control.TemplatedControl.extend({templateID:"beginDelineationControlTemplate",initializeControlInstance:function(){var n,t,i,r,u;stopClickPropagation(this.parentElement);this.getTrackedElement("delineationTypeOptions").hidden=!0;n=this;this.parentElement.querySelectorAll("[name='flowOption']").forEach(function(t){L.DomEvent.on(t,"click",function(){n.disableDelineationButton();n.displayDelineationOptionsForFlowOption(this.value)})});t=this.treatmentBMPFeature.properties.DelineationURL?"Revise the Catchment Area":"Draw the Catchment Area";this.getTrackedElement("delineationOptionDrawText").innerHTML=t;i=this.getTrackedElement("cancelDelineationButton");L.DomEvent.on(i,"click",function(n){window.delineationMap.removeBeginDelineationControl();n.stopPropagation()});r=this.getTrackedElement("continueDelineationButton");L.DomEvent.on(r,"click",function(){this.delineate()}.bind(this));u=this.getTrackedElement("closeBeginDelineationControlButton");L.DomEvent.on(u,"click",function(n){window.delineationMap.removeBeginDelineationControl();n.stopPropagation()})},initialize:function(n,t){this.treatmentBMPFeature=t;L.setOptions(this,n)},displayDelineationOptionsForFlowOption:function(n){n==="Distributed"?(this.enableDelineationButton(),this.getTrackedElement("noFlowOptionSelectedText").hidden=!0,this.getTrackedElement("delineationTypeOptions").hidden=!1,this.getTrackedElement("delineateOptionTrace").hidden=!0,this.getTrackedElement("delineationOptionDraw").hidden=!1):n==="Centralized"&&(this.enableDelineationButton(),this.getTrackedElement("noFlowOptionSelectedText").hidden=!0,this.getTrackedElement("delineationTypeOptions").hidden=!1,this.getTrackedElement("delineateOptionTrace").hidden=!1,this.getTrackedElement("delineationOptionDraw").hidden=!0)},delineate:function(){var n=jQuery("input[name='flowOption']:checked").val(),t;window.delineationMap.delineationType=n;t={delineationType:n,delineationStrategy:STRATEGY_MANUAL};n==="Distributed"?window.delineationMap.launchDrawCatchmentMode(t):n==="Centralized"&&window.delineationMap.launchTraceDelineateMode()},enableDelineationButton:function(){this.getTrackedElement("continueDelineationButton").removeAttribute("disabled")},disableDelineationButton:function(){this.getTrackedElement("continueDelineationButton").setAttribute("disabled","disabled")},preselectDelineationType:function(n){jQuery("input[name='flowOption'][value='"+n+"']").prop("checked",!0)}});L.control.beginDelineation=function(n,t){return new L.Control.BeginDelineation(n,t)};