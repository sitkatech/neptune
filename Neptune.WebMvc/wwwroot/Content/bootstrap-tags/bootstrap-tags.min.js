(function(n){"use strict";function t(t,r){var u,f,o;if(this.options=n.extend(!0,{},i,r),u=this,u.options.values_url&&n.ajax({dataType:"json",type:"get",async:!1,url:u.options.values_url}).done(function(t){typeof t=="object"&&(u.options.values=n.merge(u.options.values,t))}),u.options.values=u.options.onLoadDefaults(u.options.values),f=n(document.createElement("span")).addClass("pills-list").appendTo(t),u.options.values=u._prepare(u.options.values),n.each(u.options.values,function(n,t){u.addTag(f,t)}),u.options.can_add){var e=n(document.createElement("input")).addClass("tag-input").attr({autocomplete:"off",type:"text"}).css("outline","none").css("width","90%").typeahead({items:"all",autoSelect:!1,source:function(n,t){jQuery.ajax({dataType:"json",type:"post",async:!0,url:u.options.suggestion_url,data:{q:n,limit:u.options.suggestion_limit},autoSelect:!1}).done(function(n){return t(n)})},updater:function(n){return n.text},displayText:function(n){return n.text}}).click(function(n){n.stopPropagation()});u.options.only_suggestions==!1&&e.keypress(function(t){if(n(this).val())return t.keyCode==13?(u._addTag(f,n(this)),!1):void 0});o=n(u.options.templates.input_pill).append(e).append(n(u.options.templates.ok_icon).css("cursor","pointer").click(function(n){n.stopPropagation();u._addTag(f,e);e.focus()})).appendTo(t)}}var i={values:[],values_url:"",templates:{pill:'<span class="badge badge-info tag-badge">{0}<\/span>',add_pill:'<span class="badge badge-success tag-badge">...<\/span>',input_pill:'<span class="badge badge-success tag-badge"><\/span>',number:" <sup><small>{0}<\/small><\/sup>",plus_icon:'<i class="icon-plus-sign tag-icon"><\/i>',delete_icon:'<i class="icon-remove-sign tag-icon" data-toggle="tooltip" title="Delete"><\/i>',ok_icon:'<i class="icon-ok-sign tag-icon"><\/i>'},limit:0,tag_link_target:"",can_delete:!0,can_add:!0,double_hilight:"#0B3549",input_name:"tags[]",lang:{"delete":"Delete",limit:"You have reached limit of only {0} tags to be added."},suggestion_limit:15,suggestion_url:"",suggestions:[],only_suggestions:!1,remove_url:"",onLoadDefaults:function(n){return n},onRemove:function(){},onError:function(n,t){alert(t)},onBeforeAdd:function(n){return n},onLoadSuggestions:function(n){return n},onDuplicate:null,onBeforeRemove:function(){return!0}};t.prototype._prepare=function(t){return n.each(t,function(n,i){if(!i)return delete t[n],!0;typeof i=="string"&&(t[n]={id:i,text:i,suggest:i});t[n].suggest=t[n].suggest||t[n].text;t[n].url=i.url||"";t[n].title=i.title||"";t[n].num=parseInt(i.num||"0")}),t};t.prototype._addTag=function(t,i,r){var e,u,f;if(r||(r=this._prepare([i.val()])[0]),i.qtip("destroy"),e=r.text,/[^a-zA-Z0-9-_\s]/.test(e)){u=["right center","left center"];f=i.parents("span.right").length>0;i.qtip({content:{text:"Only letters, numbers, spaces, dashes and underscores are allowed."},position:{my:u[f?0:1],at:u[f?1:0],viewport:n(window)},show:{ready:!0},hide:"unfocus",style:{classes:"ui-tooltip-red"}});return}this.addTag(t,r)&&i.val("").focus()};t.prototype.addTag=function(t,i){var r=this,u,e,o,f,s,h;if(!i)return!1;if(parseInt(r.options.limit)>0&&t.children().length>=parseInt(r.options.limit)){r.options.onError(10,r.options.lang.limit.format(r.options.limit));return!1}if(typeof i.id=="undefined"||typeof i.text=="undefined"){r.options.onError(11,"Not correct object format to create tag/pill");n.error("Not correct object format to create tag/pill")}if(u="",n.each(t.children(),function(t,r){if(i.id.toString().toLowerCase()==n(r).data("tag-id").toString().toLowerCase())return u=n(r),!1}),u)if(r.options.onDuplicate){if(r.options.onDuplicate(u,i)!=!0)return!1}else return e=n(t.children()[0]).css("background-color"),u.stop().animate({backgroundColor:r.options.double_hilight},100,"swing",function(){u.stop().animate({backgroundColor:e},100,"swing",function(){u.css("background-color","")})}),!1;return i=r.options.onBeforeAdd(i),i.url&&(o=i.title?' data-toggle="tooltip" title="'+i.title+'"':"",i.text='<a class="tag-link" '+o+' target="'+r.options.tag_link_target+'" href="'+i.url+'">'+i.text+"<\/a>"),f="",r.options.can_delete&&(f=n(document.createElement("a")).attr({href:"javascript:void(0)","class":"tag-remove"}).html(r.options.templates.delete_icon.toString()).click(function(){r.removeTag(this)})),s=i.num>0?r.options.templates.number.format(i.num):"",h=n(r.options.templates.pill.format(i.text)).attr("data-tag-id",i.id).append(s,f,n(document.createElement("input")).attr({"data-tag-hidden":i.id,name:r.options.input_name,type:"hidden",value:i.id})).css({overflow:"hidden","white-space":"nowrap"}),t.append(h),n('[data-toggle="tooltip"]').tooltip(),!0};t.prototype.removeTag=function(t){var i=this,r=n(t).closest("[data-tag-id]");i.options.onBeforeRemove(r)!==!1&&r.animate({width:0,"padding-right":0,"padding-left":0},200,"swing",function(){var t=n(this);i.options.remove_url&&n.ajax({dataType:"json",type:"post",async:!1,url:i.options.remove_url,data:{id:t.data("tag-id")}});i.options.onRemove(t);t.remove()})};n.fn.tags=function(i){return this.each(function(){new t(n(this),i)})}})(window.jQuery);String.prototype.format||(String.prototype.format=function(){var n=arguments;return this.replace(/{(\d+)}/g,function(t,i){return typeof n[i]!="undefined"?n[i]:t})});
//# sourceMappingURL=bootstrap-tags.min.js.map
