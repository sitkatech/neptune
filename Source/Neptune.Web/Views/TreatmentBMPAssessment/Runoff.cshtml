@*-----------------------------------------------------------------------
<copyright file="Runoff.cshtml" company="Tahoe Regional Planning Agency">
Copyright (c) Tahoe Regional Planning Agency. All rights reserved.
<author>Sitka Technology Group</author>
</copyright>

<license>
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License <http://www.gnu.org/licenses/> for more details.

Source code is available upon request via <support@sitkatech.com>.
</license>
-----------------------------------------------------------------------*@
@using Newtonsoft.Json.Linq
@inherits Neptune.Web.Views.TreatmentBMPAssessment.Runoff

@{
    SetLayout("SiteLayout.cshtml", ViewDataTyped);
}

<script type="text/javascript" src="@Url.Content("~/Areas/Stormwater/Views/TreatmentBMPAssessment/ObservationAddRowSingleValueController.js")"></script>
<script type="text/javascript">
    // <![CDATA[
    angular.module("NeptuneApp")
        .factory("angularModelAndViewData",
            function()
            {
                return {
                    AngularModel: @Html.Raw(JObject.FromObject(Model)),
                    AngularViewData: @Html.Raw(JObject.FromObject(ViewDataTyped.ViewDataForAngular))
                    };
            });

    jQuery(document).ready(function () {       
        HookupCheckIfFormIsDirtyNoDisable(undefined);
    });
    // ]]>
</script>

    <p>
        Qualitatively estimate the degree to which a surface is able to rapidly infiltrate stormwater. Click Add below to enter the time it takes for 1L of water poured rapidly from a height of 4 inches to infiltrate the surface. Use the Notes field to describe the location of the observation. Use the guide below to determine how many observations to record.
    </p>
<table class="table table-condensed tableInfo">
    <thead>
        <tr class="row">
            <th class="col-xs-4">BMP area (square feet)</th>
            <th class="col-xs-2">&lt;100</th>
            <th class="col-xs-2">100-500</th>
            <th class="col-xs-2">500-1000</th>
            <th class="col-xs-2">&gt;1000</th>
        </tr>
    </thead>
    <tbody>
        <tr class="row">
            <td class="col-xs-4">Number of measurements required</td>
            <td class="col-xs-2">3</td>
            <td class="col-xs-2">4</td>
            <td class="col-xs-2">5</td>
            <td class="col-xs-2">6</td>
        </tr>
    </tbody>
</table>
@using (Html.BeginForm())
{
    <div ng-app="NeptuneApp" id="MaterialAccumulationAngularApp" ng-controller="ObservationAddRowSingleValueController" ng-init="initializeWithEmptyRow()">        
        <table class="table observationList" ng-hide="AngularModel.TreatmentBMPObservationDetailSimples.length === 0">
            <thead>
            <tr class="row">
                <th class="col-xs-1"></th>
                <th class="col-xs-3">@Html.Label("Measurement Type")e</th>
                <th class="col-xs-2">@Html.Label("Time (s)")</th>
                <th class="col-xs-6">@Html.Label("Notes")</th>
            </tr>
            </thead>
            <tr class="row" ng-repeat="row in AngularModel.TreatmentBMPObservationDetailSimples | orderBy:'TreatmentBMPObservationDetailID'">
                <td class="col-xs-1">
                    <span class="glyphicon glyphicon-trash blue"
                          title="Remove '{{row.TreatmentBMPObservationDetailTypeDisplayName}}'"
                          alt="Remove '{{row.TreatmentBMPObservationDetailTypeDisplayName}}'"
                          ng-click="deleteTreatmentBMPObservationDetail(row)"
                          style="cursor: pointer">
                    </span>
                </td>
                <td class="col-xs-3">
                    <input type="hidden" value="{{row.TreatmentBMPObservationDetailID}}"
                           name="TreatmentBMPObservationDetailSimples[{{$index}}].TreatmentBMPObservationDetailID" />
                    <input type="hidden" value="{{row.TreatmentBMPObservationDetailTypeID}}"
                           name="TreatmentBMPObservationDetailSimples[{{$index}}].TreatmentBMPObservationDetailTypeID" />
                    <span ng-bind="getTreatmentBMPObservationDetailTypeDisplayName(row)"></span>
                </td>
                <td class="col-xs-2">
                    <input name="TreatmentBMPObservationDetailSimples[{{$index}}].TreatmentBMPObservationValue" class="form-control " type="text" ng-model="row.TreatmentBMPObservationValue" style="width: 100%" required />
                </td>
                <td class="col-xs-6">
                    <input name="TreatmentBMPObservationDetailSimples[{{$index}}].Notes" class="form-control " type="text" ng-model="row.Notes" style="width: 100%" />
                </td>
            </tr>
        </table>
        <button class="btn btn-trpa pull-right" type="button" ng-click="addTreatmentBMPObservationDetail()">
            <span class="glyphicon glyphicon-plus"></span>Add Runoff Observation
        </button>
        <div class="clearfix"></div>
    </div>

    <div class="wizardButtonGroup">
        <hr>
        <button type="submit" class="btn btn-trpa" value="false" name="@Html.NameFor(x => x.AutoAdvance)">Save</button>
        <button type="submit" class="btn btn-trpa" value="true" name="@Html.NameFor(x => x.AutoAdvance)">Save &amp; Continue</button>
    </div>
}
