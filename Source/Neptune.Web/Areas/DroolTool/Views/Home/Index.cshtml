@using Neptune.Web.Views.Shared
@using Newtonsoft.Json
@using Newtonsoft.Json.Linq
@inherits Neptune.Web.Areas.DroolTool.Views.Home.Index

@section JavascriptAndStylesContent
{
    @{ MapJavascriptIncludes.RenderPartialView(Html); }
    <script src="@Url.Content("~/Content/JQuery/jquery.toast.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/ScriptsCustom/Maps/NeptuneMaps.GeoServerMap.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Areas/DroolTool/Views/Home/DroolToolMap.js")" type="text/javascript"></script>
    <link rel="stylesheet" href="@Url.Content("~/Content/JQuery/jquery.toast.min.css")"/>
    <script>

        window.mapInitJson =
            @Html.Raw(JObject.FromObject(ViewDataTyped.StormwaterMapInitJson).ToString(Formatting.None));
        window.mapConfig = @Html.Raw(JObject.FromObject(ViewDataTyped.DroolToolMapConfig).ToString(Formatting.None));

        initResizeHandler(window.mapInitJson);
    </script>
    <meta name="Description" content="Neptune provides public access to program information and details on watershed, habitat, stormwater, forestry, air quality, and projects implemented by Neptune partners." />

    <style>
        .container-fluid.droolToolContent {
            margin: 0;
            padding: 0;
            border: 0;
            width: 100%;
        }

        .neighborhood-search-control {
            /* todo: width should really be dynamish*/
            width: 280px;
            max-width: 280px;
        }
        .neighborhood-detail-control {
            /* todo: width should really be dynamish*/
            width: 280px;
            max-width: 280px;
        }

        .selectedNeighborhoodText {
            margin-bottom: 15px;
        }

        #nominatimSearchInput {
            margin-top: 15px;
        }
    </style>
}

@{ ViewPageContent.RenderPartialView(Html, ViewDataTyped.ViewPageContentViewData); }

@section DroolToolMap
{
    <div class="container-fluid" id="@ViewDataTyped.StormwaterMapInitJson.MapDivID" style="width: 100%; height: 1000px;"></div>

    <script>
        jQuery(function () {
            window.map = new NeptuneMaps.DroolToolMap(window.mapInitJson, "Terrain", "@ViewDataTyped.GeoserverUrl", window.mapConfig);

            jQuery(".leaflet-top.leaflet-right")
                .append(jQuery(".leaflet-control-zoom"));
            jQuery(".leaflet-top.leaflet-right")
                .append(jQuery(".leaflet-control-fullscreen"));
        });
    </script>

    <div id="hiddenOnLoadControlElements" style="display: none;">
        <div class="row"  id="nominatimSearchWrapper">
            <div class="col-sm-12">
                <div class="input-group">
                    <input type="text" class="form-control" id="nominatimSearchInput" style="outline: currentcolor none medium; margin-top: 0; " placeholder="Search by address or landmark">
                    <span class="input-group-btn"><a class="btn btn-sm btn-neptune" id="nominatimSearchButton" style="height: 34px; color: white; padding-top: 7px;"><i class="glyphicon glyphicon-search"></i></a></span>
                </div>
            </div>
        </div>
    </div>
}
