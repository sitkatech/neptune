NeptuneMaps.ParcelSearch=function(n,t,i,r){NeptuneMaps.GeoServerMap.call(this,n,t,i);this.parcelSummaryUrl=r;var u="OCStormwater:Parcels";this.wmsParams=this.createWmsParamsWithLayerName(u);this.wfsParams=this.createWfsParamsWithLayerName(u);this.addWmsLayer(u,"All Parcels");this.map.on("click",this.selectParcel,this)};NeptuneMaps.ParcelSearch.prototype=Sitka.Methods.clonePrototype(NeptuneMaps.GeoServerMap.prototype);NeptuneMaps.ParcelSearch.prototype.findParcelAndAddToMap=function(n){var t={cql_filter:"ParcelNumber='"+n+"'"};jQuery("#parcelSearch").val("");this.selectParcelByWFS(t)};NeptuneMaps.ParcelSearch.prototype.selectParcelByWFS=function(n){var t=this,i;Sitka.Methods.isUndefinedNullOrEmpty(this.selectedFeature)||(this.map.removeLayer(this.selectedFeature),this.layerControl.removeLayer(this.selectedFeature));i=L.Util.extend(this.wfsParams,n);SitkaAjax.ajax({url:this.geoserverUrlOWS+L.Util.getParamString(i),dataType:"json",jsonpCallback:"getJson"},function(n){t.selectedFeature=L.geoJson(n,{style:function(){return{stroke:!0,strokeColor:"#ff0000",fillColor:"FFFFFF",fillOpacity:0}},onEachFeature:function(n){jQuery("#parcelAddressFinder").val(n.properties.ParcelAddress);SitkaAjax.load(jQuery("#parcelAddressResultDetails"),t.parcelSummaryUrl+"/"+n.properties.ParcelNumber);$(".typeahead").typeahead("val","")}}).addTo(t.map);var i=t.selectedFeature.getBounds();i.isValid()&&t.map.fitBounds(i)})};NeptuneMaps.ParcelSearch.prototype.selectParcel=function(n){var t={cql_filter:"intersects(ParcelGeometry, POINT("+n.latlng.lat+" "+n.latlng.lng+"))"};this.selectParcelByWFS(t)};